[DEFAULT]
STEPS_LARIAT = raw slicer blreco reco2D
LARSOFT_REFERENCE_VERSION_LARIAT=default
BASEFILENAME_RUN1_LARIAT=lariat_r006099_sr0504
BASEFILENAME_RUN2_LARIAT=lariat_r009535_sr0400
EXPCODE_LARIAT=lariatsoft
EXPSCRIPT_LARIAT=ci_regression_test_lariatsoft.sh
INPUTFILEDIR_LARIAT=/pnfs/lariat/persistent/users/vito/ci_tests_inputfiles

[test_runner]
parallel_limit=20

[test ci_slicer_RUN1_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=1
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_slicer_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_blreco_RUN1_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=2
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_blreco_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_slicer_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_reco2D_RUN1_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=3
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_reco2D_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_blreco_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_slicer_RUN2_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=1
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_slicer_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_blreco_RUN2_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=2
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_blreco_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_slicer_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_reco2D_RUN2_regression_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/%(EXPSCRIPT_LARIAT)s
STEP=3
NEVENTS=1
args=%(NEVENTS)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s %(EXPCODE_LARIAT)s %(STEPS_LARIAT)s
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_reco2D_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_blreco_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmaskLinux.txt %(INPUTFILEDIR_LARIAT)s/testmaskDarwin.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000



[suite quick_test_lariatsoft]
testlist=ci_slicer_RUN1_regression_test_lariatsoft ci_blreco_RUN1_regression_test_lariatsoft ci_reco2D_RUN1_regression_test_lariatsoft ci_slicer_RUN2_regression_test_lariatsoft ci_blreco_RUN2_regression_test_lariatsoft ci_reco2D_RUN2_regression_test_lariatsoft


# Sequential tests
[test ci_slicer_RUN1_regression_seq_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=1
STAGE=slicer
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s_Current_%(STAGE)s.root %(BASEFILENAME_RUN1_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_blreco_RUN1_regression_seq_test_lariatsoft]
requires=ci_slicer_RUN1_regression_seq_test_lariatsoft
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=2
STAGE=blreco
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s_Current_%(STAGE)s.root ../%(requires)s/%(BASEFILENAME_RUN1_LARIAT)s_Current_slicer.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_reco2D_RUN1_regression_seq_test_lariatsoft]
requires=ci_blreco_RUN1_regression_seq_test_lariatsoft
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=2
STAGE=reco2D
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN1_LARIAT)s_Current_%(STAGE)s.root ../%(requires)s/%(BASEFILENAME_RUN1_LARIAT)s_Current_blreco.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN1_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_slicer_RUN2_regression_seq_test_lariatsoft]
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=1
STAGE=slicer
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s_Current_%(STAGE)s.root %(BASEFILENAME_RUN2_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_raw_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_blreco_RUN2_regression_seq_test_lariatsoft]
requires=ci_slicer_RUN2_regression_seq_test_lariatsoft
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=2
STAGE=blreco
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s_Current_%(STAGE)s.root ../%(requires)s/%(BASEFILENAME_RUN2_LARIAT)s_Current_slicer.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000

[test ci_reco2D_RUN2_regression_seq_test_lariatsoft]
requires=ci_blreco_RUN2_regression_seq_test_lariatsoft
script=${LARIATSOFT_DIR}/test/ci_regression_seq_test_lariatsoft.sh
NEVENTS=10
STEP=2
STAGE=reco2D
args=%(NEVENTS)s %(STAGE)s %(STEP)s %(LARSOFT_REFERENCE_VERSION_LARIAT)s %(EXPCODE_LARIAT)s %(BASEFILENAME_RUN2_LARIAT)s_Current_%(STAGE)s.root ../%(requires)s/%(BASEFILENAME_RUN2_LARIAT)s_Current_blreco.root
inputfiles=%(INPUTFILEDIR_LARIAT)s/%(BASEFILENAME_RUN2_LARIAT)s_Reference_%(STAGE)s_%(LARSOFT_REFERENCE_VERSION_LARIAT)s.root %(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
# inputfiles=%(INPUTFILEDIR_LARIAT)s/testmask_seq.txt
parse_art_output=True
mem_usage_range=100:20000000
cpu_usage_range=10:60000


[suite seq_test_lariatsoft]
testlist=ci_slicer_RUN1_regression_seq_test_lariatsoft ci_blreco_RUN1_regression_seq_test_lariatsoft ci_reco2D_RUN1_regression_seq_test_lariatsoft ci_slicer_RUN2_regression_seq_test_lariatsoft ci_blreco_RUN2_regression_seq_test_lariatsoft ci_reco2D_RUN2_regression_seq_test_lariatsoft
